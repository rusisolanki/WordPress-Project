(window.webpackJsonp=window.webpackJsonp||[]).push([[397],{1534:function(e,t,n){"use strict";n.r(t);n(43),n(26),n(15),n(61),n(34),n(33);var r=n(1),o=(n(19),n(204),n(23),n(16),n(127)),d=n(161),l=n(21),c=n(30),f=n.n(c),m=n(405);function v(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,d=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return d=e.done,e},e:function(e){l=!0,o=e},f:function(){try{d||null==n.return||n.return()}finally{if(l)throw o}}}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function h(){return y.apply(this,arguments)}function y(){return(y=Object(r.a)(regeneratorRuntime.mark((function e(){var t,n,r,o,d,c,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l.a.debug("Handling UserSignup UTM params"),e.next=3,new Promise((function(e){return setTimeout(e,1e3)}));case 3:if(t=window.$nuxt.$api){e.next=6;break}return e.abrupt("return");case 6:n={},r=v(m.a);try{for(r.s();!(o=r.n()).done;)d=o.value,sessionStorage.getItem(d)&&(n[d]=sessionStorage.getItem(d))}catch(e){r.e(e)}finally{r.f()}if(0!==Object.keys(n).length){e.next=11;break}return e.abrupt("return");case 11:return e.prev=11,e.next=14,t.get("/api/v3/users/me");case 14:return c=e.sent,data=c.data,e.next=18,t.patch("/api/v3/users/".concat(data.id,"/setup"),n);case 18:e.next=26;break;case 20:if(e.prev=20,e.t0=e.catch(11),e.t0.response){e.next=24;break}throw e.t0;case 24:if(404!==e.t0.response.status){e.next=26;break}return e.abrupt("return",h());case 26:case"end":return e.stop()}}),e,null,[[11,20]])})))).apply(this,arguments)}d.a.$on(o.a.UserSignedIn,(function(e){var t,n,r=e.user,c=e.method,m=e.enterprise,v=e.track_analytics,w=void 0===v||v;l.a.debug("Handling UserSignedIn",r);var h="user_".concat(r.attributes.sub);if(w&&d.a.$emit(o.a.AnalyticsGA4Event,{event:"login",userId:h,method:c}),null===(t=window.$nuxt)||void 0===t||null===(n=t.$rollbar)||void 0===n||n.configure({payload:{person:{id:h}}}),f.a.remove("unauthed_cart"),!m.is_whitelabel){var y=r.attributes.given_name||void 0;window.Intercom("boot",{name:y||void 0,app_id:"fuchdm6u",user_id:h,email:r.attributes.email,eid:m.id})}})),d.a.$on(o.a.UserRegistered,(function(e){var t,n,r=e.user,c=e.method,m=e.enterprise;l.a.debug("Handling UserRegistered",r);var v="user_".concat(r.attributes.sub);if(d.a.$emit(o.a.AnalyticsGA4Event,{event:"sign_up",userId:v,method:c}),null===(t=window.$nuxt)||void 0===t||null===(n=t.$rollbar)||void 0===n||n.configure({payload:{person:{id:v}}}),f.a.remove("unauthed_cart"),!m.is_whitelabel){var w=r.attributes.given_name||void 0;window.Intercom("boot",{app_id:"fuchdm6u",user_id:v,name:w,email:r.attributes.email,eid:m.id})}})),d.a.$on(o.a.UserUpdatedAttributes,(function(e){var t=e.user,n=e.enterprise;l.a.debug("Handling UserUpdatedAttributes",t),f.a.remove("unauthed_cart"),n.is_whitelabel||(t.given_name||t.family_name)&&window.Intercom("update",{name:t.given_name+" "+t.family_name})})),d.a.$on(o.a.UserSignedOut,(function(e){var t,n,r=e.enterprise;l.a.debug("Handling UserSignedOut"),null===(t=window.$nuxt)||void 0===t||null===(n=t.$rollbar)||void 0===n||n.configure({payload:{person:null}}),r.is_whitelabel||window.Intercom("shutdown")})),d.a.$on(o.a.UserRegistered,h)}}]);